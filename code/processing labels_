{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"gsgZOh1BJ85U","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1704718381385,"user_tz":-420,"elapsed":17432,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"4c20251e-add3-4b7f-f67e-9465de9592ea"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["import os\n","from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["from glob import glob\n","dir = glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/*.zip')\n","dir"],"metadata":{"id":"up0SST7BM_2R","executionInfo":{"status":"ok","timestamp":1704679133870,"user_tz":-420,"elapsed":294,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"6b9ecab7-f526-4df8-8d0f-25c19c788193","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data.zip',\n"," '/content/drive/MyDrive/AI_HACKATHON_NEWBEES/public_test.zip']"]},"metadata":{},"execution_count":2}]},{"cell_type":"code","source":["dir[1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"F-tgp6iHy2Le","executionInfo":{"status":"ok","timestamp":1704679145557,"user_tz":-420,"elapsed":14,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"b964a45e-f170-4bfb-aeda-b8fa578ec1fb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'/content/drive/MyDrive/AI_HACKATHON_NEWBEES/public_test.zip'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":3}]},{"cell_type":"code","source":["import zipfile\n","with zipfile.ZipFile(dir[1], 'r') as zip_ref:\n","    zip_ref.extractall('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/')"],"metadata":{"id":"TUdtgERrtXjt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"a-txkSMRwfPy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","labels = pd.read_csv('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/labels.csv')"],"metadata":{"id":"AUB2e5ITHMYI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"MHd4z4AM9ywj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# processing list in row\n","labels"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"hNmngUQzUxse","executionInfo":{"status":"ok","timestamp":1704563747929,"user_tz":-420,"elapsed":3,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"e9e73c6b-2820-4a2b-a366-633582c52b85"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["            file_name  height  width  \\\n","0       100013282.jpg    1333   2000   \n","1       100016175.jpg    1333   2000   \n","2        10004189.jpg    2000   1333   \n","3       100104575.jpg    1333   2000   \n","4       100104600.jpg    2000   1333   \n","...               ...     ...    ...   \n","15305  image_2713.jpg    1024   1024   \n","15306  image_3332.jpg    1024   1024   \n","15307  image_6905.jpg    1024   1024   \n","15308  image_4080.jpg    1024   1024   \n","15309  image_8309.jpg    1024   1024   \n","\n","                                                    bbox     age       race  \\\n","0      [934.0000000000097, 144.82228672769534, 238.24...  20-30s  Caucasian   \n","1      [1094.0513571635438, 422.91772295627203, 55.45...  20-30s  Caucasian   \n","2      [419.93871061403877, 269.1250391680045, 377.19...  20-30s  Mongoloid   \n","3      [1490.6909678848915, 676.0000000000097, 37.553...  20-30s  Caucasian   \n","4      [549.169724453414, 92.52040334013152, 306.8821...  20-30s  Caucasian   \n","...                                                  ...     ...        ...   \n","15305  [244.71717171717162, 176.66666666666654, 587.2...  40-50s  Caucasian   \n","15306  [265.6338028169031, 174.2441314553992, 584.727...  Senior  Caucasian   \n","15307  [251.3434343434343, 184.7171717171712, 500.535...  20-30s  Caucasian   \n","15308  [222.72727272727235, 179.8181818181809, 586.90...     Kid  Caucasian   \n","15309  [169.37373737373707, 141.48484848484836, 566.2...    Baby  Caucasian   \n","\n","         masked   skintone    emotion  gender  \n","0      unmasked  mid-light    Neutral    Male  \n","1      unmasked      light    Neutral    Male  \n","2      unmasked      light  Happiness  Female  \n","3      unmasked  mid-light    Neutral    Male  \n","4      unmasked  mid-light  Happiness  Female  \n","...         ...        ...        ...     ...  \n","15305  unmasked  mid-light  Happiness    Male  \n","15306  unmasked      light  Happiness  Female  \n","15307  unmasked      light    Neutral    Male  \n","15308  unmasked      light  Happiness  Female  \n","15309  unmasked      light    Neutral  Female  \n","\n","[15310 rows x 10 columns]"],"text/html":["\n","  <div id=\"df-1644471f-83d3-481c-82fa-9c583c6e9186\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>file_name</th>\n","      <th>height</th>\n","      <th>width</th>\n","      <th>bbox</th>\n","      <th>age</th>\n","      <th>race</th>\n","      <th>masked</th>\n","      <th>skintone</th>\n","      <th>emotion</th>\n","      <th>gender</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>100013282.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[934.0000000000097, 144.82228672769534, 238.24...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>100016175.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[1094.0513571635438, 422.91772295627203, 55.45...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>10004189.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>[419.93871061403877, 269.1250391680045, 377.19...</td>\n","      <td>20-30s</td>\n","      <td>Mongoloid</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>100104575.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[1490.6909678848915, 676.0000000000097, 37.553...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>100104600.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>[549.169724453414, 92.52040334013152, 306.8821...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>15305</th>\n","      <td>image_2713.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[244.71717171717162, 176.66666666666654, 587.2...</td>\n","      <td>40-50s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>15306</th>\n","      <td>image_3332.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[265.6338028169031, 174.2441314553992, 584.727...</td>\n","      <td>Senior</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>15307</th>\n","      <td>image_6905.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[251.3434343434343, 184.7171717171712, 500.535...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>15308</th>\n","      <td>image_4080.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[222.72727272727235, 179.8181818181809, 586.90...</td>\n","      <td>Kid</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>15309</th>\n","      <td>image_8309.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[169.37373737373707, 141.48484848484836, 566.2...</td>\n","      <td>Baby</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Female</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>15310 rows × 10 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1644471f-83d3-481c-82fa-9c583c6e9186')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-1644471f-83d3-481c-82fa-9c583c6e9186 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-1644471f-83d3-481c-82fa-9c583c6e9186');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-891d8470-73a8-4a38-9482-075aa4128e4b\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-891d8470-73a8-4a38-9482-075aa4128e4b')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-891d8470-73a8-4a38-9482-075aa4128e4b button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["# # prompt: convert string to list in each row pandas\n","\n","# labels['labels'] = labels['labels'].apply(lambda x: x.split(','))"],"metadata":{"id":"Z0IHCzttbDuo","colab":{"base_uri":"https://localhost:8080/","height":513},"executionInfo":{"status":"error","timestamp":1704561452681,"user_tz":-420,"elapsed":270,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"bd68ea98-5b20-4065-aeb6-361d0cbcca04"},"execution_count":null,"outputs":[{"output_type":"error","ename":"KeyError","evalue":"'labels'","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3801\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3802\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcasted_key\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3803\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/_libs/index.pyx\u001b[0m in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[0;34m()\u001b[0m\n","\u001b[0;32mpandas/_libs/hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[0;34m()\u001b[0m\n","\u001b[0;32mpandas/_libs/hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[0;34m()\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 'labels'","\nThe above exception was the direct cause of the following exception:\n","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-14-410ce31ae321>\u001b[0m in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# prompt: convert string to list in each row pandas\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mlabels\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'labels'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlabels\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'labels'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mapply\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m','\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m   3805\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnlevels\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3806\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_getitem_multilevel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3807\u001b[0;31m             \u001b[0mindexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3808\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mis_integer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3809\u001b[0m                 \u001b[0mindexer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mindexer\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36mget_loc\u001b[0;34m(self, key, method, tolerance)\u001b[0m\n\u001b[1;32m   3802\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_loc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcasted_key\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3803\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3804\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3805\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mTypeError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3806\u001b[0m                 \u001b[0;31m# If we have a listlike key, _check_indexing_error will raise\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 'labels'"]}]},{"cell_type":"code","source":["labels['list_bbox'] = labels['bbox'].apply(lambda x: list(map(float, x.strip('[]').split(','))))"],"metadata":{"id":"9wdRKhaSbDzC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["labels['bbox'][0]"],"metadata":{"id":"a_C8py43cP-v","executionInfo":{"status":"ok","timestamp":1704488669032,"user_tz":-420,"elapsed":7,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"5e91bd98-a561-45bd-9232-1b73301a37b5","colab":{"base_uri":"https://localhost:8080/","height":35}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'[934.0000000000097, 144.82228672769534, 238.24562254582438, 330.0662796338281]'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["labels['list_bbox'][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Js6vcJSGbD2u","executionInfo":{"status":"ok","timestamp":1704488662843,"user_tz":-420,"elapsed":2,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"73959efa-711d-4e52-cf3e-61916bc465d1"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[934.0000000000097, 144.82228672769534, 238.24562254582438, 330.0662796338281]"]},"metadata":{},"execution_count":72}]},{"cell_type":"markdown","source":["Split data training and test"],"metadata":{"id":"mMXC1wxAbA42"}},{"cell_type":"code","source":["import numpy as np\n","img_test = np.random.choice(labels.file_name.unique(), 3000, replace=False)\n","len(set(img_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"byhQPkccHTn2","executionInfo":{"status":"ok","timestamp":1704563758324,"user_tz":-420,"elapsed":2,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"957ca68e-d1bf-46ad-f708-42ee4d2e708c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["3000"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["label_test = labels[labels.file_name.isin(img_test)].copy().reset_index(drop=True)\n","label_train = labels[~labels.file_name.isin(img_test)].copy().reset_index(drop=True)\n","label_test.file_name.nunique(), label_train.file_name.nunique()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7mfRBJUuWmgj","executionInfo":{"status":"ok","timestamp":1704563758748,"user_tz":-420,"elapsed":2,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"0cb9a141-6fa7-46e3-90bb-610c04711b62"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3000, 12000)"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["label_test.to_csv('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/labels_test.csv', index=False)\n","label_train.to_csv('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/labels_train.csv', index=False)"],"metadata":{"id":"KW4LRJ-VW1ZH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_test = pd.read_csv('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/labels_test.csv')\n","label_train = pd.read_csv('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/labels_train.csv')"],"metadata":{"id":"8MdSd88RhpDy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["label_test.file_name.nunique(), label_train.file_name.nunique()"],"metadata":{"id":"Tt8WMUaeaxaE","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1704607678191,"user_tz":-420,"elapsed":6,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"e91a4b3d-6634-4eda-9f00-c4e3bc89f6be"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3000, 12000)"]},"metadata":{},"execution_count":11}]},{"cell_type":"markdown","source":["Move data"],"metadata":{"id":"eRu2sOz2a2d9"}},{"cell_type":"code","source":["import os\n","import shutil"],"metadata":{"id":"naJGXQTxkUp5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from glob import glob"],"metadata":{"id":"BPjI0ovNmrzH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["root_dir = '/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/data/'"],"metadata":{"id":"XbA53VVUyKD0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for dir_img in label_test.file_name.unique():\n","  shutil.copy(root_dir + dir_img, '/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/test/')\n","print(\"done test\")\n","\n","for dir_img in label_train.file_name.unique():\n","  shutil.copy(root_dir + dir_img, '/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/train/')\n","print(\"done train\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yhX5jBYcyv22","executionInfo":{"status":"ok","timestamp":1704611928679,"user_tz":-420,"elapsed":4227647,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"dbf455db-acd6-4dc5-c9b1-a32c625770f8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["done test\n","done train\n"]}]},{"cell_type":"code","source":["print(\"train\", len(glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/train/*.jpg')))\n","print(\"test\", len(glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_processed/test/*.jpg')))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CgLE8HCrz0XP","executionInfo":{"status":"ok","timestamp":1704612343192,"user_tz":-420,"elapsed":4933,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"9c52da86-9afa-4a3e-a003-30a0f245faad"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["train 12000\n","test 3000\n"]}]},{"cell_type":"code","source":["all_dir = glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/data/*.jpg')\n","len(all_dir)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GC9fcOfdaxdI","executionInfo":{"status":"ok","timestamp":1704568059920,"user_tz":-420,"elapsed":3315,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"82e73dee-4867-41e9-941b-d75477217472"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["15000"]},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["all_dir = glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/data/*.jpg')\n","len(all_dir)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XCGjDkq67wTj","executionInfo":{"status":"ok","timestamp":1704564038688,"user_tz":-420,"elapsed":2,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"b97060da-76b0-4349-966f-f4685a12ebbc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1646"]},"metadata":{},"execution_count":30}]},{"cell_type":"code","source":["for dir in all_dir:\n","  shutil.move(dir, \"/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/\")\n","print(\"done\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"r6dZd3Fdaxi0","executionInfo":{"status":"ok","timestamp":1704558346464,"user_tz":-420,"elapsed":21928,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"d9415426-25d4-45d5-95ec-af3d627f1a6a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["done\n"]}]},{"cell_type":"code","source":["len(glob('/content/drive/MyDrive/AI_HACKATHON_NEWBEES/data_raw/data/*.jpg'))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eL_pwHMLl-g-","executionInfo":{"status":"ok","timestamp":1704607396986,"user_tz":-420,"elapsed":108887,"user":{"displayName":"Thịnh Vũ Đức","userId":"10883447843124679803"}},"outputId":"87cd0302-4fc5-4e34-add1-3214ffeae45f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["15000"]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":[],"metadata":{"id":"Us5TZ4jRmd-6"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## split label"],"metadata":{"id":"n93fZF6NIXzW"}},{"cell_type":"code","source":["labels"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"yJaiJcG7Icyj","executionInfo":{"status":"ok","timestamp":1704718499357,"user_tz":-420,"elapsed":320,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"032e15a7-5533-4839-bb7f-0957bb29034d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["            file_name  height  width  \\\n","0       100013282.jpg    1333   2000   \n","1       100016175.jpg    1333   2000   \n","2        10004189.jpg    2000   1333   \n","3       100104575.jpg    1333   2000   \n","4       100104600.jpg    2000   1333   \n","...               ...     ...    ...   \n","15305  image_2713.jpg    1024   1024   \n","15306  image_3332.jpg    1024   1024   \n","15307  image_6905.jpg    1024   1024   \n","15308  image_4080.jpg    1024   1024   \n","15309  image_8309.jpg    1024   1024   \n","\n","                                                    bbox     age       race  \\\n","0      [934.0000000000097, 144.82228672769534, 238.24...  20-30s  Caucasian   \n","1      [1094.0513571635438, 422.91772295627203, 55.45...  20-30s  Caucasian   \n","2      [419.93871061403877, 269.1250391680045, 377.19...  20-30s  Mongoloid   \n","3      [1490.6909678848915, 676.0000000000097, 37.553...  20-30s  Caucasian   \n","4      [549.169724453414, 92.52040334013152, 306.8821...  20-30s  Caucasian   \n","...                                                  ...     ...        ...   \n","15305  [244.71717171717162, 176.66666666666654, 587.2...  40-50s  Caucasian   \n","15306  [265.6338028169031, 174.2441314553992, 584.727...  Senior  Caucasian   \n","15307  [251.3434343434343, 184.7171717171712, 500.535...  20-30s  Caucasian   \n","15308  [222.72727272727235, 179.8181818181809, 586.90...     Kid  Caucasian   \n","15309  [169.37373737373707, 141.48484848484836, 566.2...    Baby  Caucasian   \n","\n","         masked   skintone    emotion  gender  \n","0      unmasked  mid-light    Neutral    Male  \n","1      unmasked      light    Neutral    Male  \n","2      unmasked      light  Happiness  Female  \n","3      unmasked  mid-light    Neutral    Male  \n","4      unmasked  mid-light  Happiness  Female  \n","...         ...        ...        ...     ...  \n","15305  unmasked  mid-light  Happiness    Male  \n","15306  unmasked      light  Happiness  Female  \n","15307  unmasked      light    Neutral    Male  \n","15308  unmasked      light  Happiness  Female  \n","15309  unmasked      light    Neutral  Female  \n","\n","[15310 rows x 10 columns]"],"text/html":["\n","  <div id=\"df-c1a1db1f-61e0-467e-acc9-aa6029a1ae4c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>file_name</th>\n","      <th>height</th>\n","      <th>width</th>\n","      <th>bbox</th>\n","      <th>age</th>\n","      <th>race</th>\n","      <th>masked</th>\n","      <th>skintone</th>\n","      <th>emotion</th>\n","      <th>gender</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>100013282.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[934.0000000000097, 144.82228672769534, 238.24...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>100016175.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[1094.0513571635438, 422.91772295627203, 55.45...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>10004189.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>[419.93871061403877, 269.1250391680045, 377.19...</td>\n","      <td>20-30s</td>\n","      <td>Mongoloid</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>100104575.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>[1490.6909678848915, 676.0000000000097, 37.553...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>100104600.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>[549.169724453414, 92.52040334013152, 306.8821...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>15305</th>\n","      <td>image_2713.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[244.71717171717162, 176.66666666666654, 587.2...</td>\n","      <td>40-50s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>15306</th>\n","      <td>image_3332.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[265.6338028169031, 174.2441314553992, 584.727...</td>\n","      <td>Senior</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>15307</th>\n","      <td>image_6905.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[251.3434343434343, 184.7171717171712, 500.535...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","    </tr>\n","    <tr>\n","      <th>15308</th>\n","      <td>image_4080.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[222.72727272727235, 179.8181818181809, 586.90...</td>\n","      <td>Kid</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","    </tr>\n","    <tr>\n","      <th>15309</th>\n","      <td>image_8309.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>[169.37373737373707, 141.48484848484836, 566.2...</td>\n","      <td>Baby</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Female</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>15310 rows × 10 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c1a1db1f-61e0-467e-acc9-aa6029a1ae4c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-c1a1db1f-61e0-467e-acc9-aa6029a1ae4c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-c1a1db1f-61e0-467e-acc9-aa6029a1ae4c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-34623886-b07e-4185-88a0-094dd87ea1cc\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-34623886-b07e-4185-88a0-094dd87ea1cc')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-34623886-b07e-4185-88a0-094dd87ea1cc button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_e966c60f-7100-4bc1-a6eb-879fa7250010\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('labels')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_e966c60f-7100-4bc1-a6eb-879fa7250010 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('labels');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["def process_bbox(data):\n","  \"\"\n","\n","  \"\"\n","  data['bbox'] = data['bbox'].str.strip('[')\n","  data['bbox'] = data['bbox'].str.strip(']')\n","  data[['x','y','w','h']] = data['bbox'].str.split(',', expand=True).astype(float).astype(int)\n","  return data"],"metadata":{"id":"MAU3Qt9SIxMJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["labels = process_bbox(labels)"],"metadata":{"id":"j5DO60FIJiOv"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["labels"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":791},"id":"1jg_4Z5MqubZ","executionInfo":{"status":"ok","timestamp":1704727343871,"user_tz":-420,"elapsed":534,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"b2f6d2c7-923c-4e67-d33e-267b7b57561d"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["            file_name  height  width  \\\n","0       100013282.jpg    1333   2000   \n","1       100016175.jpg    1333   2000   \n","2        10004189.jpg    2000   1333   \n","3       100104575.jpg    1333   2000   \n","4       100104600.jpg    2000   1333   \n","...               ...     ...    ...   \n","15305  image_2713.jpg    1024   1024   \n","15306  image_3332.jpg    1024   1024   \n","15307  image_6905.jpg    1024   1024   \n","15308  image_4080.jpg    1024   1024   \n","15309  image_8309.jpg    1024   1024   \n","\n","                                                    bbox     age       race  \\\n","0      934.0000000000097, 144.82228672769534, 238.245...  20-30s  Caucasian   \n","1      1094.0513571635438, 422.91772295627203, 55.453...  20-30s  Caucasian   \n","2      419.93871061403877, 269.1250391680045, 377.190...  20-30s  Mongoloid   \n","3      1490.6909678848915, 676.0000000000097, 37.5539...  20-30s  Caucasian   \n","4      549.169724453414, 92.52040334013152, 306.88213...  20-30s  Caucasian   \n","...                                                  ...     ...        ...   \n","15305  244.71717171717162, 176.66666666666654, 587.24...  40-50s  Caucasian   \n","15306  265.6338028169031, 174.2441314553992, 584.7276...  Senior  Caucasian   \n","15307  251.3434343434343, 184.7171717171712, 500.5353...  20-30s  Caucasian   \n","15308  222.72727272727235, 179.8181818181809, 586.909...     Kid  Caucasian   \n","15309  169.37373737373707, 141.48484848484836, 566.28...    Baby  Caucasian   \n","\n","         masked   skintone    emotion  gender     x    y    w    h  \n","0      unmasked  mid-light    Neutral    Male   934  144  238  330  \n","1      unmasked      light    Neutral    Male  1094  422   55   71  \n","2      unmasked      light  Happiness  Female   419  269  377  491  \n","3      unmasked  mid-light    Neutral    Male  1490  676   37   70  \n","4      unmasked  mid-light  Happiness  Female   549   92  306  437  \n","...         ...        ...        ...     ...   ...  ...  ...  ...  \n","15305  unmasked  mid-light  Happiness    Male   244  176  587  828  \n","15306  unmasked      light  Happiness  Female   265  174  584  797  \n","15307  unmasked      light    Neutral    Male   251  184  500  798  \n","15308  unmasked      light  Happiness  Female   222  179  586  714  \n","15309  unmasked      light    Neutral  Female   169  141  566  751  \n","\n","[15310 rows x 14 columns]"],"text/html":["\n","  <div id=\"df-b109f8f0-c2ae-4aa5-b0f3-5d9d355c88da\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>file_name</th>\n","      <th>height</th>\n","      <th>width</th>\n","      <th>bbox</th>\n","      <th>age</th>\n","      <th>race</th>\n","      <th>masked</th>\n","      <th>skintone</th>\n","      <th>emotion</th>\n","      <th>gender</th>\n","      <th>x</th>\n","      <th>y</th>\n","      <th>w</th>\n","      <th>h</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>100013282.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>934.0000000000097, 144.82228672769534, 238.245...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","      <td>934</td>\n","      <td>144</td>\n","      <td>238</td>\n","      <td>330</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>100016175.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>1094.0513571635438, 422.91772295627203, 55.453...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","      <td>1094</td>\n","      <td>422</td>\n","      <td>55</td>\n","      <td>71</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>10004189.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>419.93871061403877, 269.1250391680045, 377.190...</td>\n","      <td>20-30s</td>\n","      <td>Mongoloid</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","      <td>419</td>\n","      <td>269</td>\n","      <td>377</td>\n","      <td>491</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>100104575.jpg</td>\n","      <td>1333</td>\n","      <td>2000</td>\n","      <td>1490.6909678848915, 676.0000000000097, 37.5539...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","      <td>1490</td>\n","      <td>676</td>\n","      <td>37</td>\n","      <td>70</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>100104600.jpg</td>\n","      <td>2000</td>\n","      <td>1333</td>\n","      <td>549.169724453414, 92.52040334013152, 306.88213...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","      <td>549</td>\n","      <td>92</td>\n","      <td>306</td>\n","      <td>437</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>15305</th>\n","      <td>image_2713.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>244.71717171717162, 176.66666666666654, 587.24...</td>\n","      <td>40-50s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>mid-light</td>\n","      <td>Happiness</td>\n","      <td>Male</td>\n","      <td>244</td>\n","      <td>176</td>\n","      <td>587</td>\n","      <td>828</td>\n","    </tr>\n","    <tr>\n","      <th>15306</th>\n","      <td>image_3332.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>265.6338028169031, 174.2441314553992, 584.7276...</td>\n","      <td>Senior</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","      <td>265</td>\n","      <td>174</td>\n","      <td>584</td>\n","      <td>797</td>\n","    </tr>\n","    <tr>\n","      <th>15307</th>\n","      <td>image_6905.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>251.3434343434343, 184.7171717171712, 500.5353...</td>\n","      <td>20-30s</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Male</td>\n","      <td>251</td>\n","      <td>184</td>\n","      <td>500</td>\n","      <td>798</td>\n","    </tr>\n","    <tr>\n","      <th>15308</th>\n","      <td>image_4080.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>222.72727272727235, 179.8181818181809, 586.909...</td>\n","      <td>Kid</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Happiness</td>\n","      <td>Female</td>\n","      <td>222</td>\n","      <td>179</td>\n","      <td>586</td>\n","      <td>714</td>\n","    </tr>\n","    <tr>\n","      <th>15309</th>\n","      <td>image_8309.jpg</td>\n","      <td>1024</td>\n","      <td>1024</td>\n","      <td>169.37373737373707, 141.48484848484836, 566.28...</td>\n","      <td>Baby</td>\n","      <td>Caucasian</td>\n","      <td>unmasked</td>\n","      <td>light</td>\n","      <td>Neutral</td>\n","      <td>Female</td>\n","      <td>169</td>\n","      <td>141</td>\n","      <td>566</td>\n","      <td>751</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>15310 rows × 14 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b109f8f0-c2ae-4aa5-b0f3-5d9d355c88da')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-b109f8f0-c2ae-4aa5-b0f3-5d9d355c88da button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b109f8f0-c2ae-4aa5-b0f3-5d9d355c88da');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-e15c41c3-bed6-4571-8aa9-c729bd3ddc53\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e15c41c3-bed6-4571-8aa9-c729bd3ddc53')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-e15c41c3-bed6-4571-8aa9-c729bd3ddc53 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_413bbffa-23c4-4bb1-b15f-839998f0d67f\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('labels')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_413bbffa-23c4-4bb1-b15f-839998f0d67f button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('labels');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["labels['emotion'].unique()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UuAnCoo0JvKC","executionInfo":{"status":"ok","timestamp":1704718731155,"user_tz":-420,"elapsed":4,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"8b6c5252-a667-474a-e92a-36dd25126a15"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['Neutral', 'Happiness', 'Anger', 'Surprise', 'Fear', 'Sadness',\n","       'Disgust'], dtype=object)"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["labels['emotion'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AbTVRh0vJwF5","executionInfo":{"status":"ok","timestamp":1704718749607,"user_tz":-420,"elapsed":2,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"ebb8faf8-01ec-44ee-a622-6266eca53311"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Happiness    9218\n","Neutral      4844\n","Sadness       380\n","Anger         319\n","Surprise      303\n","Disgust       132\n","Fear          114\n","Name: emotion, dtype: int64"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["labels['age'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1704728786177,"user_tz":-420,"elapsed":431,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"f6d33404-6ae3-401b-cc8b-afca11776c27","id":"g_WwVOIHwOpI"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["20-30s      11236\n","40-50s       1602\n","Kid           954\n","Senior        637\n","Teenager      536\n","Baby          345\n","Name: age, dtype: int64"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["labels['race'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UhpilUHSwPF8","executionInfo":{"status":"ok","timestamp":1704728802757,"user_tz":-420,"elapsed":2,"user":{"displayName":"Nguyễn Văn Thùy","userId":"13343204588086918249"}},"outputId":"515fa87f-9664-4244-bf3b-0a2950c50ebc"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Mongoloid    7487\n","Caucasian    7106\n","Negroid       717\n","Name: race, dtype: int64"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":[],"metadata":{"id":"86urCJlAwTOL"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}